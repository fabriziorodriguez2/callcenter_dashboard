<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Dashboard Operativo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="./styles.css" />
  <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script defer src="./app.js?v=6"></script>
</head>
<body>
  <header class="topbar" role="banner">
    <div class="brand-wrap">
      <img src="LOGO-SSG.png" alt="SSG Assistance" class="logo" />
      <h1 class="brand">Dashboard</h1>
    </div>
  </header>

  <main class="container">
    <!-- FILTROS -->
    <section class="card" aria-labelledby="filtros-title">
      <h2 id="filtros-title" class="section-title">Filtros</h2>
      <div class="filters-row">
        <label class="field">
          <span>Desde</span>
          <input id="start" class="input" type="datetime-local" />
        </label>
        <label class="field">
          <span>Hasta</span>
          <input id="end" class="input" type="datetime-local" />
        </label>

        <!-- Campaña: ID o nombre/código -->
        <label class="field small">
          <span>Campaña (nombre/código o ID)</span>
          <div class="ac-wrap">
            <input id="campaign_id" class="input" type="text" autocomplete="off"
                   placeholder="p. ej. Retención, VENTA2025 o 2" />
            <div id="campaignListBox" class="ac-list" role="listbox" aria-label="Sugerencias de campaña"></div>
          </div>
        </label>

        <!-- Agente: ID o usuario/nombre -->
        <label class="field small">
          <span>Agente (usuario/nombre o ID)</span>
          <div class="ac-wrap">
            <input id="agent_id" class="input" type="text" autocomplete="off"
                   placeholder="p. ej. mgonzalez, María Gon... o 5" />
            <div id="agentListBox" class="ac-list" role="listbox" aria-label="Sugerencias de agente"></div>
          </div>
        </label>

        <div class="actions">
          <button id="btnFetch" class="btn">Aplicar</button>
          <button id="btnSave" class="btn primary">Guardar snapshot</button>
        </div>
      </div>
    </section>

    <!-- KPIs -->
    <section class="kpis" aria-label="Indicadores clave">
      <article class="kpi card">
        <div class="kpi-title">Contactabilidad</div>
        <div id="kpi_contact" class="kpi-value">—</div>
      </article>
      <article class="kpi card">
        <div class="kpi-title">Penetración Bruta</div>
        <div id="kpi_pb" class="kpi-value">—</div>
      </article>
      <article class="kpi card">
        <div class="kpi-title">Penetración Neta</div>
        <div id="kpi_pn" class="kpi-value">—</div>
      </article>
    </section>

    <!-- GRÁFICA -->
    <section class="card" aria-labelledby="dist-title">
      <h2 id="dist-title" class="section-title">Distribución por resultado</h2>
      <div class="chart-wrap">
        <canvas id="distChart" height="220" aria-label="Gráfico de distribución" role="img"></canvas>
      </div>
    </section>

    <!-- DETALLES -->
    <section class="card" aria-labelledby="detalles-title">
      <h2 id="detalles-title" class="section-title">Detalles</h2>
      <div class="table-wrap">
        <table id="distTable">
          <thead>
            <tr><th>Resultado</th><th>Cantidad</th></tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- SNAPSHOTS -->
    <section class="card" aria-labelledby="shots-title">
      <h2 id="shots-title" class="section-title">Snapshots</h2>
      <div id="snapshots" class="snapshots"></div>
    </section>
  </main>

  <!-- Botón flotante: Configurar API -->
  <button id="btnSettings" class="fab" title="Configurar API" aria-label="Configurar API">⚙️</button>

  <!-- MODAL -->
  <div id="modal" class="modal" aria-hidden="true">
    <div class="modal-backdrop"></div>
    <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal-header">
        <div id="modalTitle" class="modal-title">Snapshot</div>
        <button id="modalClose" class="btn ghost" aria-label="Cerrar">✕</button>
      </div>
      <div id="modalBody" class="modal-body"></div>
      <div class="modal-footer">
        <button id="modalClose2" class="btn">Cerrar</button>
      </div>
    </div>
  </div>

  <!-- TOAST -->
  <div id="toast" class="toast" role="status" aria-live="polite">OK</div>
</body>
</html>
